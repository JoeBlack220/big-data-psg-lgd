\documentclass{article}
\usepackage[T1]{fontenc}
\usepackage{geometry}
\geometry{a4paper}
\usepackage{setspace}
\usepackage{enumerate}
\usepackage{enumitem}
\usepackage{hyperref}
\hypersetup{colorlinks,allcolors=black,urlcolor=blue}

\setenumerate[1]{itemsep=0pt,partopsep=2pt,parsep=0pt ,topsep=2pt}
\setitemize[1]{itemsep=0pt,partopsep=2pt,parsep=0pt ,topsep=2pt}
\setenumerate[2]{itemsep=0pt,partopsep=2pt,parsep=0pt ,topsep=2pt}
\setitemize[2]{itemsep=0pt,partopsep=2pt,parsep=0pt ,topsep=2pt}
\setdescription{itemsep=0pt,partopsep=2pt,parsep=0pt ,topsep=2pt}

\usepackage{graphicx}
\usepackage{fontspec}

\defaultfontfeatures{%
	RawFeature={%
		% +swsh,
		+calt
	}%
}

\setmainfont{EB Garamond}

\usepackage{multicol}

\usepackage[semibold]{sourcecodepro}

\usepackage{xcolor}
\usepackage{minted}
\usemintedstyle{friendly}

\definecolor{bg}{rgb}{0.95,0.95,0.95}
\newcommand{\codeinline}[1]{
	\mintinline[bgcolor=bg, fontsize=\scriptsize]{text}{#1}
}

\newenvironment{console}{% Caution:
	\VerbatimEnvironment
	\begin{minted}[xleftmargin=2em,bgcolor=bg,fontsize=\small]{console}% Do NOT delete these comments
	}% Otherwise there will be error when compiling
	{%
	\end{minted}%
}

%-----------%

\title{NoSQL Proof-of-Concept Proposal}
\author{
	Team name: PSG.LGD \\ \\
	Yichun Yan \\
	Ziwei Jiang \\
	Yifan Li \\
	Weiqi Wang
}
\date{\today}



\begin{document}

\maketitle

\tableofcontents
\clearpage

%-------%

\section{Dota2 Game Replay Analysis}
\subsection{Potential Datasets}
Our team aims at exploring data about a popular and long-lived computer game, Dota2. We will primarily get our data from the following three origins:

\begin{enumerate}
\item \href{https://wiki.teamfortress.com/wiki/WebAPI}{Dota2's official API}
\item \href{https://docs.opendota.com/}{OpenDota API}
\item Valve's Dota2 replay servers
\end{enumerate}

We will get the match results data from Dota2's official API. Also we get the data we need to retrieve a replay from replay servers, then get replays. So basically we will have two different kinds of data for our further analysis, relatively large-scale but coarse-grained match results data, and very fine-grained replays data. Considering the file size of one replay, we decide to only include recent professional games for the replay data. Specifically, we can collect them by the following instructions:

\begin{enumerate}
\item Match Results:
	\begin{itemize}
		\item Use \href{https://wiki.teamfortress.com/wiki/WebAPI/GetMatchHistoryBySequenceNum}{GetMatchHistoryBySequenceNum} API to get the match ids, we will need a a field called \\ \codeinline{start_at_match_seq_num} to specify the starting match sequence number of the results. 
		\item Then  we can extract the last sequence number of the results as the \codeinline{start_at_match_seq_num} for the next call. By doing this iteratively we can enlarge our dataset for our first kind of data.
	\end{itemize}
\item Replays:
	\begin{itemize}
		\item Get the match ids of recent professional games from the first dataset we collect.
		\item Use the those ids via \href{https://docs.opendota.com/#tag/matches}{OpenDota API} to get the information we need \\ (\codeinline{cluster} and \codeinline{replay_salt}) for retrieving replays from Valve's replay server
		\item Constructing links in this format:\\  \codeinline{ http://replay<cluster>.valve.net/570/<match_id>_<replay_salt>.dem.bz2} to get the replays.
	\end{itemize}
\end{enumerate}

\subsection{Five Vs of Datasets}
To assess the adequacy of adopting big data to our project, we firstly identify five Vs characteristics of our dataset.\\
\textbf{Volume}\\
Replays are one of datasets we plan to use, which are the full records of finished matches. Size of one replay is estimated to be about 60MB. We plan to collect 3000 replays whose size is about 180GB. As for match result data which is JSON-format data, size of each result is about 5KB. We plan to collect 10,000,000 match results whose size is about 50GB. Moreover, if we desire more data in the future implementation, we can always access it as long as dota 2 still has players.\\
\textbf{Velocity}\\
According to the statistic data in August 2019 from Steam which is a a video game digital distribution platform, the average number of players is 467,148.3 players and the peak number is 826,690. The large number of players makes both the replay data and result data high-velocity. Although, in our project, the velocity depends on the velocity of the API request. This statistic data reveals that it's potential to be high-velocity.\\
\textbf{Variety}\\
From the APIs mentioned above, we can directly access JSON format file, the match result data and binary format file, the replay data. The replay data will be transformed to strings by a parser.\\
\textbf{Veracity}\\
The overall quality of our datasets is good, because we access most of  them from the offical API. But there is still a few noise. For example, the time of a game is too short, which makes this game not representative. Thus, we plan to implement the data validation to filter the undesired matches.\\
\textvf{Value}\\
Our datasets are useful for a relatively long time. Because we plan to collect 1/3 professional matches and 2/3 public matches. The professional matches are durable since we can always extract information about professional teams and players from them. As for the normal games, they are valuable as long as they are not too stale, like more than 2 years ago. In data validation step, we will set a filter on date for normal games which makes our datasets valueable.

\subsection{Datasets Description}

We found the approaches to get those data on a \href{https://dev.dota2.com}{developer's forum of Dota2}. Valve's official document of many APIs is outdated so the forum is the only way for us to understand the resulting data.

The match results data is in JSON format, which contains snapshot information about a game's end, like how much gold one player earned at the end of the match, and also contains some information after a match, like how many players thumbs-up the game.

The JSON file for one match will be between 3KB\textasciitilde 5KB, we planed to collect 1,000,000 matches' results data, which will add up to about 5GB.

The replay data is originally in binary format, but we found an open-source program to parse it into strings. So we will be handling the logs of all the activity happens in a single game. We may further parse this file considering that the file size of one single match and it contains many irrelevant information. The size of one replay's size is between 20MB\textasciitilde 80MB. We plan to collect 1,000 matches' replays, which will add up to about 50GB.



\subsection{Data Preprocessing and Specification}

As the raw data is completely unstructured \codeinline{.dem.bz2} file,
preliminary preprocessing must be done before we store the data in our database.

Firstly, we can decompress the \codeinline{.bz2} file with \codeinline{bzip2},
which will give us a \codeinline{.dem} file:

\begin{console}
$ bzip2 -d data.dem.bz2
\end{console}

Next, we can utilize \href{https://github.com/skadistats/clarity}{clarity},
an open source Dota2 replay parser, to extract useful information from the \codeinline{.dem} file.
Based on our exploration and the \href{https://github.com/skadistats/clarity-examples}{examples}
provided by clarity, the following data will be available:

\begin{itemize}
	% info
	\item Player name, id, team formation and hero choice
	% combatlog
	\item Detailed log of the game, including a hero:
	\begin{itemize}
		\item deals damage to another one
		\item heals another one
		\item receives/loses a buff/debuff
		\item kills another one
		\item uses his ability
		\item uses an item
		\item buys an item
		\item receives/loses some gold
		\item gains some XP
		\item buys back (spending money in order to instantly re-spawn)
	\end{itemize}
	% lifestate
	\item Spawn/death of heros and NPCs
	% matchend
	\item Summary of each player's performance in the whole match, including:
	\begin{itemize}
		\item Final level
		\item Kills
		\item Deaths
		\item Assistance
		\item Gold
		\item Last hit
		\item Deny
	\end{itemize}
\end{itemize}


% --------------------------------------------

% Except for those listed above:

% Run success but hard to find meaning:
% 	dump, dumpbaselines, dumpmana, gameevent, modifiers, particles
%	propertychange, resources, seek, spawngroups, stringtabledump, tick

% Run failed: allchat, livesource, metadata, serializers,

% Unknown:
%   - dtinspector: Seems to provide a GUI interface but I(LYF) run in docker, which raises an exception.
%	- entityrun: No output
%	- matchend: Produced result but also raises exception
%	- tempentities: No output

% --------------------------------------------

\subsection{Potential Business Questions}

As mentioned before, we can collect 2 kinds of data, one is match results and one is replays. A match result is in JSON format which provides us statistic information about every player and the entire game at the end of a game. To gain information during a game instead of at the end, we can use preprocessed replay data. By analyzing collected data, the following questions might be answered.
\begin{itemize}
    \item Easy questions:
    \begin{itemize}
        \item Who is the hero gaining gold/XP fastest in 15 minutes in normal games/professional games?
        \item Who is the hero having most kills/assists/heals/deaths in normal games/professional games?
        \item What is the most purchased item in normal games/professional games?
        \item Who is the hero having most bad-manner players (players who are AFK or disconnected)?
        \item Who is the most popular hero (hero who has highest pick rate) in normal games/professional games?
        \item Who is the hero having highest ban rate in professional games?
        \item who is the hero having the most ban/pick rate in professional games?
        \item How long does a game cost in average in normal games/professional games?
        \item Which item is used most in normal games/professional games?
    \end{itemize}
    \item Moderately challenging questions:
    \begin{itemize}
        \item How is the benefits gained from buybacks in normal games/professional games？
        \item How is the vision in normal games/professional games?
        \item When does the first team battle happen in normal games/professional games?
        \item Which is lineup having highest win rate in normal games/professional games?
        \item Which is the most popular lineup (lineup which has the highest pick rate) in normal games/professional games?
        \item which is the most common ban-pick combo in professional games?
        \item Who is hero changed most in win/pick/ban rate after release new version of dota 2?
    \end{itemize}
    \item Challenging questions:
    \begin{itemize}
        \item Does there exist correlation between the time of the first blood and the time of the entire game?
        \item Does there exist correlation between the gold/XP source of a hero and its win rate?
        \item Does there exist correlation between the distribution of economy and the result of the game?
        \item Does there exist correlation between the economic development and the time of the first team battle?
    \end{itemize}
\end{itemize}
Moreover, we can use answers above to analyze the difference between normal games and professional games as well as the difference between the blind-pick game and the draft-pick game.


The following fields are critical to answering our Business Question, ``???".
They will need to be cleansed and validated.

% TODO:
% In order to "Describe fields that are critical for your analysis that will need to be cleansed/validated.",
% I need the Business Question first



%-------%



\end{document}



